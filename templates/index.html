<!DOCTYPE html>
<html>
<head>
    <title>DrugGPT</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container mt-5">
    <div class="card shadow-lg p-5" style="max-width: 800px; margin: auto;">
        <h1 class="text-center mb-4 text-primary">DrugAI</h1>
        <p class="text-center text-muted fs-5">Ask me any sickness — I’ll tell you what drugs real patients actually use</p>

        <div class="input-group input-group-lg mb-5">
            <input type="text" id="sickness" class="form-control" placeholder="e.g. malaria, diabetes, depression, pain, acne..." autofocus>
            <button class="btn btn-success" onclick="searchFind()">Find Drugs</button>
        </div>

        <div id="result" class="mt-4"></div>
    </div>
</div>

<script>
async function searchFind() {
    const sickness = document.getElementById("sickness").value.trim();
    if (!sickness) return;

    const res = await fetch("/recommend", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({sickness: sickness})
    });

    const data = await res.json();

    if (data.error) {
        document.getElementById("result").innerHTML = `<div class="alert alert-warning">${data.error}</div>`;
        return;
    }

    let html = `
        <div class="alert alert-info text-center">
            <h3>Most Common Drugs for <strong>${data.sickness}</strong></h3>
            <p>Based on <strong>${data.total_patients.toLocaleString()}</strong> real patient reports</p>
        </div>
        <ol class="list-group list-group-numbered">
    `;

    data.most_common_drugs.forEach(d => {
        html += `
            <li class="list-group-item d-flex justify-content-between align-items-center py-3">
                <div>
                    <strong class="fs-5">${d.drug}</strong><br>
                    <small class="text-muted">${d.stars} ${d.rating}/10 rating</small>
                </div>
                <span class="badge bg-primary rounded-pill fs-6" style="background: #0d6efd;">
                    ${d.patients.toLocaleString()} patients (${d.percentage}%)
                </span>
            </li>`;
    });

    html += `</ol><small class="text-muted d-block mt-4 text-center">Educational only • Not medical advice</small>`;
    document.getElementById("result").innerHTML = html;
}
</script>
</body>
</html>